# Git&Github

# 一、版本控制

集中式版本控工具 SYN等  单点故障

分布式版本控制工具 Git等 本地具有完整的历史

**GIT优势**

- 大部分操作本地完成，不需要联网
- 完整性保证 哈希计算
- 尽可能添加数据而不是删除或修改数据
- 分支操作快捷流畅
- 与Linux命令全面兼容

# 二、Git简介

## 2.1 Git结构

历史版本---》本地库

|

git commit

|

临时存储---》暂存区

|

git add

|

写代码---》工作区

## 2.2 Git和代码托管中心

代码托管中心的任务：维护远程库

- 局域网环境下
  - GitLab服务器
- 外网环境下
  - GitHub
  - 码云

## 2.3 本地库和远程库

团队内：（A）本地库---》push--->远程库----》（B）clone---->本地库-----》push（加入团队）----》远程库----->（A）pull---》拉取

团队外：乙fork一个甲的远程库，然后clone\push，pull request，然后甲审核后merge到自己的远程库

  # 三、Git命令行操作

## 3.1 本地库初始化

- 命令：git add

- 效果：

![image-20221227020757887](C:\Users\Margaret\AppData\Roaming\Typora\typora-user-images\image-20221227020757887.png)

- 注意事项：.git目录中存放的是本地库相关的子目录和文件，不要删除，也不要胡乱的修改。

## 3.2 设置签名

- 形式：
  - 用户名：
  - Email地址：
- 作用：区分不同开发人员的身份
- 辨析：这里设置的签名和登录远程库（代码托管中心）的账号密码没有任何关系。
- 命令
  - 项目（仓库）级别：仅在当前本地库范围内有效
    - git config
      - git config user.name tom_pro
      - git config user.email tom@qq.com
      - 信息保存位置：./.git/config文件
  - 系统用户级别：登陆当前操作系统的用户范围
    - git config --global
      - git config --global user.name tom_pro
      - git config --global user.email tom@qq.com
      - 信息保存位置：~/.gitconfig文件
  - 级别优先级
    - 就近原则：项目级别优先于系统用户级别，二者都有时，采用项目级别的签名
    - 如果只有系统用户级别的签名，以2系统用户级别为准
    - 二者都没有，不允许

## 3.3 基本操作

- 状态查看：git status  查看工作区、缓存区状态

- 添加操作：git add [file name]  将工作区的“新建/修改”添加到暂存区

- 提交操作：git commit -m "commit message"[file name] 将暂存区的内容提交到本地库

- 查看历史纪录

  - git log

    - 多屏显示控制方式：
      - 空格向下翻页
      - b向上翻页
      - 退出

  - git log --pretty=oneline

  - git log --oneline

  - git reflog (HEAD@{移动到当前版本需要多少步})

    ![image-20221228004636593](C:\Users\Margaret\AppData\Roaming\Typora\typora-user-images\image-20221228004636593.png)

- 前进后退

  - 本质：HEAD指针
  - 基于索引值操作（推荐）
    - git reset --hard[局部索引值]
  - 使用^符号（只能往后退，不能往前）
    - git reset --hard HEAD^  (^符号可以一次性写多个，多少个表示后退多少步)
  - 使用~符号（只能后退，不能往前）
    - git reset --hard HEAD~n  直接后退n步

- reset命令三个参数的对比

  - --soft参数
    - 仅仅在本地库移动HEAD指针
  - --mixed参数
    - 在本地库移动HEAD指针
    - 重置暂存区
  - --hard参数(一般用这个)
    - 在本地库移动HEAD指针
    - 重置暂存区
    - 重置工作区

- 删除文件并找回

  - 前提：删除前，文件存在的状态提交到了本地库
  - 操作：git reset --hard[指针位置]
    - 删除操作已经提交到本地库：指针位置指向历史记录
    - 删除操作尚未提交到本地库：指针位置使用HEAD

- 比较文件差异

  - git diff [文件名]
    - 将工作区中的文件和暂存区进行比较
  - git diff [本地库中历史版本]  [文件名]
    - 将工作区中的文件和本地库历史记录进行比较
  - 不带文件名的比较多个文件
    - git diff HEAD

## 3.4 分支管理

- 什么是分支？在版本控制过程中，使用多条线同时推进多个任务。
- 分支的好处
  - 同时并行推进多个功能开发，提高开发效率
  - 各个分支开发过程中 ，如果 某一个分支开发失败，不会对其他分支有任何影响。失败的分支删除重新开始即可。
- 分支操作
  - 创建分支：git branch [分支名]
  - 查看分支：git branch -v
  - 切换分支：git checkout [分支名]
  - 合并分支：
    - 第一步：切换到接受修改的分支（被合并，增加新内容）上
      - git checkout[被合并分支名]
    - 第二步：执行merge命令
      - git merge[有新内容的分支名]
  - 解决冲突：
    - 第一步：编辑文件，删除特殊符号
    - 第二步：把文件修改到满意的程度
    - 第三步：git add[文件名]
    - 第四步：git commit -m "日志信息"
      - 注意：此时commit一定不能带文件名

# 四、 Git基本原理

## 4.1哈希

哈希是一个系列的加密算法，各个不同的算法虽然加密强度不同，但是有几个共同点：

- 不管输入的数据量有多大，输入同一个哈希算法，得到的加密结果长度固定。
- 哈希算法确定，输入数据确定，输入数据能够保证不变。
- 哈希算法确定，输入结果有变化，输出数据一定有变化，而且通常变化很大。
- 哈希算法不可逆。
- Git底层采用的是SHA-１算法。
- 哈希算法可以被用来验证文件，Git就是靠这种机制从根本上保证数据完整性的。

## 4.2Git保存版本的控制

### 4.2.1集中式版本控制工具的文件管理机制

以文件变更列表的方式存储信息。这类系统将他们保存的信息看作是一组基本文件和每个文件随时间逐步累积的差异。

### 4.2.2Git的文件管理机制

Git把数据看作是小型文件系统的一组快照。每次提交更新时Git 都会对当前的全部文件制作一个快照并保存这个快照的索引。为了高效，如果文件没有修改，Git 不在重新存储该文件，而是只保留一个连接指向之前存储的文件。所以Git的工作方式可以称之为快照流。

## 4.3Git分支管理机制

# 五、Github

## 5.1 创建远程库

## 5.2 推送到远程库

git remote add origin [远程库地址]

## 5.3 克隆

- 命令

  - git clone [远程地址]

- 命令效果

  - 完成的把远程库下载到本地

  - 创建origin远程地址别名

  - 初始化本地库

## 5.4 团队成员邀请

settings--->collabortors---->copy invitelink

被邀请人访问地址并接受

## 5.5 拉取

- pull = fetch+merge
- git fetch [远程库地址别名] [远程分支名]
- git merge [远程库地址别名/远程分支名]

## 5.6 解决冲突

- 要点
  - 如果不是基于github远程库的最新版做的修改，不能推送，必须先拉取。
  - 拉去下来后如果进入冲突状态，则按照“分支冲突解决”操作解决即可。

## 5.7跨团队协作

- fork
- 本地修改，然后推送到远程
- pull request
- 对话
- 审核代码
- merge pull request
- 将远程库修改拉到本地

## 5.8 SSH免密登录

- 进入当前用户家目录 cd ~
- 删除.ssh目录 rm -rvf .ssh
- 运行命令生成.ssh密钥目录 ssh -keygen -t rsa -C [用户名]
- 进入.ssh目录查看文件列表 cd .ssh   ls-IF
- 查看id_rsa.pub文件内容 cat id_rsa.pub
- 复制id_rsa.pub文件内容，登录Github,点击用户头像-》Settings->SSH and GPG keys
- New SSH key
- 输入复制的密钥消息
- 回到Gitbash创建远程地址别名

# 六、Git工作流



